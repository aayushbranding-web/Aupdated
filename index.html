<!DOCTYPE html><html lang="en"><head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Billing System</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(to right, #f8f9fa, #e9ecef);
      padding: 40px;
      color: #343a40;
    }
    h2 {
      color: #212529;
      margin-bottom: 20px;
    }
    .field {
      margin-bottom: 15px;
      transition: all 0.3s ease;
    }
    input, select, button {
      padding: 10px;
      margin-top: 5px;
      border-radius: 8px;
      border: 1px solid #ced4da;
      width: 100%;
      box-sizing: border-box;
      font-size: 16px;
    }
    button {
      background-color: #007bff;
      color: white;
      cursor: pointer;
      margin-top: 10px;
    }
    button:hover {
      background-color: #0056b3;
    }
    #eveningSummaryBtn {
      display: none;
      background-color: #28a745;
    }
    .summary {
      margin-top: 30px;
      padding: 20px;
      background-color: white;
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.05);
    }
  </style>
</head><body>
  <h2>Billing System</h2>  <div class="field">
    <label>Item:</label><br />
    <select id="item">
      <option value="">Select</option>
      <option>Chuda Rakhi</option>
      <option>Baccha Rakhi</option>
      <option>Rakhi</option>
      <option>Moli</option>
      <option>Mehandi</option>
      <option>Joda Rakhi</option>
      <option>Puja Rakhi</option>
    </select>
  </div>  <div class="field">
    <label>Quantity:</label><br />
    <input type="number" id="quantity" />
  </div>  <div class="field">
    <label>Rate:</label><br />
    <input type="number" id="rate" />
  </div>  <div class="field">
    <label>Discount:</label><br />
    <input type="number" id="discount" placeholder="Enter discount" />
    <select id="discountType">
      <option value="â‚¹">â‚¹</option>
      <option value="%">%</option>
    </select>
  </div>  <div class="field">
    <label>Paid:</label><br />
    <input type="number" id="paid" />
  </div>  <div class="field">
    <label>Payment Mode:</label><br />
    <select id="paymentMode" onchange="togglePaymentNumber()">
      <option value="">Select</option>
      <option value="Cash">Cash</option>
      <option value="Online">Online</option>
    </select>
  </div>  <div class="field" id="paymentNumberField" style="display: none;">
    <label>Payment Done On:</label><br />
    <select id="paymentNumber">
      <option value="">Select</option>
      <option value="7742065298">7742065298</option>
      <option value="6350455314">6350455314</option>
    </select>
  </div>  <div class="field">
    <label>Estimate No:</label>
    <span id="estimateNo"></span>
  </div>  <div class="field">
    <label>Total Before Discount:</label>
    <span id="totalBeforeDiscount">0</span>
  </div>  <div class="field">
    <label>Total After Discount:</label>
    <span id="total">0</span>
  </div>  <div class="field">
    <label>Balance:</label>
    <span id="balance">0</span>
  </div><button onclick="generateBill()">Generate WhatsApp Message</button> <button onclick="resetBill()">ðŸ”„ Reset</button> <button id="eveningSummaryBtn" onclick="generateEveningSummary()">ðŸ“Š Evening Summary</button>

  <div class="summary" id="eveningSummaryContainer" style="display:none">
    <label>Today's Sale:</label>
    <span id="todaySale">0</span><br /><br />
    <label>Previous Sale:</label>
    <input type="number" id="previousSale" /><br /><br />
    <label>Total Sale:</label>
    <span id="combinedSale">0</span><br /><br />
    <button onclick="sendEveningSummary()">Send Summary to WhatsApp</button>
  </div>  <script>
    function togglePaymentNumber() {
      const mode = document.getElementById('paymentMode').value;
      document.getElementById('paymentNumberField').style.display = mode === 'Online' ? 'block' : 'none';
    }

    let estimateNumber = localStorage.getItem('estimateNumber') || 1;
    document.getElementById('estimateNo').textContent = estimateNumber;

    let todayTotalSale = 0;

    function generateBill() {
      const item = document.getElementById('item').value;
      const quantity = +document.getElementById('quantity').value;
      const rate = +document.getElementById('rate').value;
      const discount = +document.getElementById('discount').value;
      const discountType = document.getElementById('discountType').value;
      const paid = +document.getElementById('paid').value;
      const paymentMode = document.getElementById('paymentMode').value;
      const paymentNumber = document.getElementById('paymentNumber').value;

      const totalBeforeDiscount = quantity * rate;
      let total = totalBeforeDiscount;
      if (discountType === 'â‚¹') {
        total -= discount;
      } else {
        total -= (total * discount / 100);
      }

      const balance = total - paid;
      document.getElementById('totalBeforeDiscount').textContent = totalBeforeDiscount;
      document.getElementById('total').textContent = total;
      document.getElementById('balance').textContent = balance;

      todayTotalSale += total;
      localStorage.setItem('todayTotalSale', todayTotalSale);

      const estimate = estimateNumber;
      const lines = [
        `ðŸ“Œ *Estimate No:* ${estimate}`,
        `| *Item*        | *Qty* | *Rate* | *Total* |`,
        `|---------------|-------|--------|---------|`,
        `| ${item}        | ${quantity}    | â‚¹${rate}   | â‚¹${totalBeforeDiscount} |`,
        `ðŸ’¸ *Discount:* ${discount}${discountType}`,
        `ðŸ’° *Paid:* â‚¹${paid}`,
        paymentMode === 'Online' ? `ðŸ’³ *Mode:* ${paymentMode} (${paymentNumber})` : `ðŸ’³ *Mode:* ${paymentMode}`
      ];

      const message = encodeURIComponent(lines.join('\n'));
      const link = `https://wa.me/?text=${message}`;
      window.open(link, '_blank');

      estimateNumber++;
      localStorage.setItem('estimateNumber', estimateNumber);
      document.getElementById('estimateNo').textContent = estimateNumber;
    }

    function resetBill() {
      document.getElementById('item').value = "";
      document.getElementById('quantity').value = "";
      document.getElementById('rate').value = "";
      document.getElementById('discount').value = "";
      document.getElementById('discountType').value = "â‚¹";
      document.getElementById('paid').value = "";
      document.getElementById('paymentMode').value = "";
      document.getElementById('paymentNumber').value = "";
      document.getElementById('paymentNumberField').style.display = 'none';
      document.getElementById('total').textContent = 0;
      document.getElementById('balance').textContent = 0;
      document.getElementById('totalBeforeDiscount').textContent = 0;
    }

    function generateEveningSummary() {
      document.getElementById('eveningSummaryContainer').style.display = 'block';
      document.getElementById('todaySale').textContent = localStorage.getItem('todayTotalSale') || 0;
    }

    function sendEveningSummary() {
      const today = +(localStorage.getItem('todayTotalSale') || 0);
      const previous = +document.getElementById('previousSale').value || 0;
      const combined = today + previous;
      document.getElementById('combinedSale').textContent = combined;

      const lines = [
        `ðŸ“… *Evening Sales Summary*`,
        `ðŸŸ¢ *Today's Sale:* â‚¹${today}`,
        `ðŸ”µ *Previous Sale:* â‚¹${previous}`,
        `ðŸ§® *Total Sale:* â‚¹${combined}`
      ];

      const msg = encodeURIComponent(lines.join('\n'));
      window.open(`https://wa.me/?text=${msg}`, '_blank');
    }

    const now = new Date();
    const currentMinutes = now.getHours() * 60 + now.getMinutes();
    const showStart = 21 * 60 + 30; // 9:30 PM
    const showEnd = 8 * 60;         // 8:00 AM
    if (currentMinutes >= showStart || currentMinutes < showEnd) {
      document.getElementById('eveningSummaryBtn').style.display = 'inline-block';
    }
  </script></body>
  </html>
