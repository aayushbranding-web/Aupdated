<!DOCTYPE html><html lang="en"><head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Billing System</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
    }
    .field {
      margin-bottom: 10px;
    }
    input, select, button {
      padding: 5px;
      margin-top: 5px;
    }
    #eveningSummaryBtn {
      display: none;
    }
  </style>
</head><body>
  <h2>Billing System</h2>  <div class="field">
    <label>Item:</label><br />
    <select id="item">
      <option value="">Select</option>
      <option>Chuda Rakhi</option>
      <option>Baccha Rakhi</option>
      <option>Rakhi</option>
      <option>Moli</option>
      <option>Mehandi</option>
      <option>Joda Rakhi</option>
      <option>Puja Rakhi</option>
    </select>
  </div>  <div class="field">
    <label>Quantity:</label><br />
    <input type="number" id="quantity" />
  </div>  <div class="field">
    <label>Rate:</label><br />
    <input type="number" id="rate" />
  </div>  <div class="field">
    <label>Discount:</label><br />
    <input type="number" id="discount" placeholder="Enter discount" />
    <select id="discountType">
      <option value="â‚¹">â‚¹</option>
      <option value="%">%</option>
    </select>
  </div>  <div class="field">
    <label>Paid:</label><br />
    <input type="number" id="paid" />
  </div>  <div class="field">
    <label>Payment Mode:</label><br />
    <select id="paymentMode" onchange="togglePaymentNumber()">
      <option value="">Select</option>
      <option value="Cash">Cash</option>
      <option value="Online">Online</option>
    </select>
  </div>  <div class="field" id="paymentNumberField" style="display: none;">
    <label>Payment Done On:</label><br />
    <select id="paymentNumber">
      <option value="">Select</option>
      <option value="7742065298">7742065298</option>
      <option value="6350455314">6350455314</option>
    </select>
  </div>  <div class="field">
    <label>Estimate No:</label>
    <span id="estimateNo"></span>
  </div>  <div class="field">
    <label>Total Before Discount:</label>
    <span id="totalBeforeDiscount">0</span>
  </div>  <div class="field">
    <label>Total After Discount:</label>
    <span id="total">0</span>
  </div>  <div class="field">
    <label>Balance:</label>
    <span id="balance">0</span>
  </div><button onclick="generateBill()">Generate WhatsApp Message</button> <button onclick="resetBill()">ðŸ”„ Reset</button> <button id="eveningSummaryBtn" onclick="window.open('evening-summary.html', '_blank')">ðŸ“Š Evening Summary</button>

  <script>
    function togglePaymentNumber() {
      const mode = document.getElementById('paymentMode').value;
      document.getElementById('paymentNumberField').style.display = mode === 'Online' ? 'block' : 'none';
    }

    let estimateNumber = parseInt(localStorage.getItem('estimateNumber')) || 1;
    document.getElementById('estimateNo').textContent = estimateNumber;

    function generateBill() {
      const item = document.getElementById('item').value;
      const quantity = +document.getElementById('quantity').value;
      const rate = +document.getElementById('rate').value;
      const discount = +document.getElementById('discount').value;
      const discountType = document.getElementById('discountType').value;
      const paid = +document.getElementById('paid').value;
      const paymentMode = document.getElementById('paymentMode').value;
      const paymentNumber = document.getElementById('paymentNumber').value;

      const totalBeforeDiscount = quantity * rate;
      let total = totalBeforeDiscount;
      if (discountType === 'â‚¹') {
        total -= discount;
      } else {
        total -= (total * discount / 100);
      }

      const balance = total - paid;
      document.getElementById('totalBeforeDiscount').textContent = totalBeforeDiscount;
      document.getElementById('total').textContent = total;
      document.getElementById('balance').textContent = balance;

      // Save total in localStorage for evening summary
      let currentTotal = parseFloat(localStorage.getItem('dailyTotal')) || 0;
      currentTotal += total;
      localStorage.setItem('dailyTotal', currentTotal);

      const estimate = estimateNumber;
      const lines = [
        `ðŸ“Œ *Estimate No:* ${estimate}`,
        `| *Item*        | *Qty* | *Rate* | *Total* |`,
        `|---------------|-------|--------|---------|`,
        `| ${item}        | ${quantity}    | â‚¹${rate}   | â‚¹${totalBeforeDiscount} |`,
        `ðŸ’¸ *Discount:* ${discount}${discountType}`,
        `ðŸ’° *Paid:* â‚¹${paid}`,
        paymentMode === 'Online' ? `ðŸ’³ *Mode:* ${paymentMode} (${paymentNumber})` : `ðŸ’³ *Mode:* ${paymentMode}`
      ];

      const message = encodeURIComponent(lines.join('\n'));
      const link = `https://wa.me/?text=${message}`;
      window.open(link, '_blank');

      estimateNumber++;
      localStorage.setItem('estimateNumber', estimateNumber);
      document.getElementById('estimateNo').textContent = estimateNumber;
    }

    function resetBill() {
      document.getElementById('item').value = "";
      document.getElementById('quantity').value = "";
      document.getElementById('rate').value = "";
      document.getElementById('discount').value = "";
      document.getElementById('discountType').value = "â‚¹";
      document.getElementById('paid').value = "";
      document.getElementById('paymentMode').value = "";
      document.getElementById('paymentNumber').value = "";
      document.getElementById('paymentNumberField').style.display = 'none';
      document.getElementById('total').textContent = 0;
      document.getElementById('balance').textContent = 0;
      document.getElementById('totalBeforeDiscount').textContent = 0;
    }

    // Show button after 9:30 PM
    const now = new Date();
    if (now.getHours() > 21 || (now.getHours() === 21 && now.getMinutes() >= 30)) {
      document.getElementById('eveningSummaryBtn').style.display = 'inline-block';
    }
  </script></body></html>
